function nmdrAlbum(t){var i=nmdr.core.$(t,"nmdrAlbum");if(null!=i)return i.albumWidth=0,i.albumHeight=0,i.slideWidth=0,i.slideHeight=0,i.thumbsCount=0,i.thumbWidth=0,i.thumbHeight=0,i.tviewWidth=0,i.imagePath="",i.animation=!1,i.imageOpened=!1,i.paddingH=2,i.paddingV=2,i.firstThumb=0,i.currentTile=0,i.currentThumb=0,i.albums=[],i.init=function(t,i,e,s,n,d,h){this.albums=t||this.createTestAlbum(),this.albumWidth=i,this.albumHeight=e,this.imagePath=s||"",this.thumbWidth=n,this.thumbHeight=d,this.thumbsCount=h,this.tviewWidth=n+10,this.slideWidth=h*this.tviewWidth+(h+3)*this.paddingH,this.slideHeight=d+36,this.build(),nmdr.core.animate.setData(10,10),nmdr.core.utils.updateOnLoadResize(this,function(t){t.build()})},i.build=function(){this.imageOpened&&this.showImage(!1);var t=[],i=0;t.push("<div class='nmdrAL_root' id='"+this.id+"_nmdrAL_root' style='background-color:#000;overflow:hidden;position:relative;width:"+this.albumWidth+"px;height:"+this.albumHeight+"px;cursor:pointer;'>"),t.push("<div class='nmdrAL_content' id='"+this.id+"_nmdrAL_content' style='position:absolute;left:0px;top:0px;width:"+this.albumWidth+"px;height:"+this.albumHeight+"px;'>");for(var e in this.albums){var s=this.albums[e],n=null!==s.title?s.title:"",d=null!==s.description?s.description:"",h=s.url;t.push("<div class='nmdrAL_box' id='"+this.id+"_nmdrAL_box"+e+"' onclick=\"nmdr.core.$('"+this.id+"').startLink('"+h+"');\" style='position:absolute;left:"+i+"px;top:0px;width:"+this.albumWidth+"px;height:"+this.albumHeight+'px;pointer-events:auto;vertical-align:bottom;text-align:right;background-image: url("'+this.imagePath+s.image+"\");'></div>"),t.push("<div class='nmdrAL_sbox' id='"+this.id+"_nmdrAL_sbox"+e+"' style='position:absolute;left:"+i+"px;top:"+(this.albumHeight-30)+"px;width:"+this.albumWidth+"px;height:"+this.albumHeight+"px;vertical-align:top;text-align:left;color:#fff;background-color:rgba(0,0,0,0.4);pointer-events:auto;'>"),t.push("<table border=0, cellpadding=0, cellspacing=0, width=100% height=100%>"),t.push("<tr><td class='nmdrAL_title'>"+n+"</td></tr>"),t.push("<tr><td class='nmdrAL_text'>"+d+"</td></tr>"),t.push("<tr><td class='nmdrAL_thumbs' id='"+this.id+"_nmdrAL_sbox"+e+"_thumbs' height='40%'></td></tr>"),t.push("</table>"),t.push("<div class='nmdrAL_slidButtons' id='"+this.id+"_nmdrAL_slidButtons"+e+"' style='position:absolute;top:4px;left:"+(this.slideWidth-60)+"px;display:inline'><div class='nmdrAL_slideTile' style='display:inline;padding:2px;'><img src='"+this.imagePath+"slideUp.png' onmouseover=\"this.src='"+this.imagePath+"slideUpH.png'\" onmouseout=\"this.src='"+this.imagePath+"slideUp.png'\" onclick=\"nmdr.core.$('"+this.id+"').slide(event, this, '"+this.id+"_nmdrAL_slidButtons"+e+"','"+this.id+"_nmdrAL_sbox"+e+"', 'up')\"/></div><div class='nmdrAL_prevTile' style='display:inline;padding:2px;'><img src='"+this.imagePath+"slideLeft.png' onmouseover=\"this.src='"+this.imagePath+"slideLeftH.png'\" onmouseout=\"this.src='"+this.imagePath+"slideLeft.png'\" onclick=\"nmdr.core.$('"+this.id+"').showPrev(event)\"/></div><div class='nmdrAL_nextTile' style='display:inline;padding:2px;'><img src='"+this.imagePath+"slideRight.png' onmouseover=\"this.src='"+this.imagePath+"slideRightH.png'\" onmouseout=\"this.src='"+this.imagePath+"slideRight.png'\" onclick=\"nmdr.core.$('"+this.id+"').showNext(event)\"/></div></div>"),t.push("</div>"),i+=this.albumWidth}t.push("</div>"),t.push("</div>"),this.innerHTML="<style type='text/css'>.nmdrAL_title {vertical-align:top; text-align:left; padding:5px 0px 0px 5px; color:#fff; font-family:arial, verdana, sans-serif; font-size:15px;height:26px;}.nmdrAL_text {vertical-align:top; text-align:left; padding:5px 0px 0px 5px; color:#fff; font-family:arial, verdana, sans-serif; font-size:13px;}.nmdrAL_thumbs {vertical-align:top;text-align:center;}</style>"+t.join("");var l=document.createElement("div");l.innerHTML="<div id='"+this.id+"_nmdrAL_divOverlay' style='display:none;position:absolute;z-index:10;top:0px;left:0px;width:1px;height:1px;background-color:white;background-color:rgba(0,0,0,0.6);vertical-align:middle;text-align:center;'></div><div id='"+this.id+"_nmdrAL_divFrame' style='position:absolute;z-index:12;display:none;border:5px solid;border-color:#fff;vertical-align:middle;text-align:center;background-color:#fff;'><table border='0' cellpadding='0' cellspacing='0' width='100%' height='100%'><tr><td colspan=2><img id='"+this.id+"_nmdrAL_showdivImage' src='"+this.imagePath+"loading.gif' style='cursor:pointer;' onmousemove=\"nmdr.core.$('"+this.id+"').showNaviButtons(event, true);\" onmouseover=\"nmdr.core.$('"+this.id+"').showNaviButtons(event, true);\" onmouseout=\"nmdr.core.$('"+this.id+"').showNaviButtons(event, false);\" onclick=\"nmdr.core.$('"+this.id+"').changeImage(event);\"><img id='"+this.id+"_nmdrAL_showdivPrev' src='"+this.imagePath+"prevlabel.gif' style='display:none;position:absolute;top:0px;left:0px;opacity:0.5;'><img id='"+this.id+"_nmdrAL_showdivNext' src='"+this.imagePath+"nextlabel.gif' style='display:none;position:absolute;top:0px;left:0px;opacity:0.5;'></td></tr><tr><td style='height:40px; text-align:left;font-family:arial,Helvetica,sans-serif;font-size:11px;font-style:normal;font-weight:normal;'><span id='"+this.id+"_nmdrAL_showdivSpan'></span></td><td style='width:80px;cursor:pointer;' onclick=\"nmdr.core.$('"+this.id+"').showImage(false)\"><img id='"+this.id+"_nmdrAL_showdivClose' src='"+this.imagePath+"closelabel.gif'></td></tr></table></div>",this.parentNode.insertBefore(l,this.nextSibling)},i.showPrev=function(t){if(nmdr.core.utils.stopPropagation(t),this.currentTile>0&&!this.animation){this.animation=!0;var i=nmdr.core.animate.stepH/this.slideWidth;nmdr.core.animate.fadeOut(this.id+"_nmdrAL_box"+this.currentTile,null,i),nmdr.core.animate.fadeIn(this.id+"_nmdrAL_box"+(this.currentTile-1),null,i),nmdr.core.animate.scroll(this.id+"_nmdrAL_content",null,this.albumWidth,0,function(t){t.currentTile--,t.animation=!1},this)}},i.showNext=function(t){if(nmdr.core.utils.stopPropagation(t),this.currentTile<this.albums.length-1&&!this.animation){this.animation=!0;var i=nmdr.core.animate.stepH/this.slideWidth;nmdr.core.animate.fadeOut(this.id+"_nmdrAL_box"+this.currentTile,null,i),nmdr.core.animate.fadeIn(this.id+"_nmdrAL_box"+(this.currentTile+1),null,i),nmdr.core.animate.scroll(this.id+"_nmdrAL_content",null,-this.albumWidth,0,function(t){t.currentTile++,t.animation=!1},this)}},i.slide=function(t,i,e,s,n){if(nmdr.core.utils.stopPropagation(t),!this.animation){this.animation=!0;var d=this,h=document.getElementById(s+"_thumbs");h.innerHTML="up"==n?"<img src='"+this.imagePath+"loading.gif'>":"",nmdr.core.animate.move(null,document.getElementById(s),null,"up"==n?0:this.albumHeight-30,function(t){h.innerHTML="up"==n?d.createThumbnails(d.albums[d.currentTile],d.currentTile):"",t.animation=!1},this),document.getElementById(e).style.top=("up"==n?this.albumHeight-26:4)+"px","up"==n?(i.src=this.imagePath+"slideDown.png",i.onclick=function(t){d.slide(t,i,e,s,"down")},i.onmouseover=function(t){i.src=d.imagePath+"slideDownH.png"},i.onmouseout=function(t){i.src=d.imagePath+"slideDown.png"}):(i.src=this.imagePath+"slideUp.png",i.onclick=function(t){d.slide(t,i,e,s,"up")},i.onmouseover=function(t){i.src=d.imagePath+"slideUpH.png"},i.onmouseout=function(t){i.src=d.imagePath+"slideUp.png"})}},i.createThumbnails=function(t,i){if(null==t.thumbs||0==t.thumbs.length)return"";for(var e='<style type="text/css">a { text-decoration:none; outline:0; color:#000; }.nmdrAL_thumbArea {overflow:hidden;overflow-x:scroll;position:absolute; padding:0px;}#'+this.id+"_nmdrAL_thumArea {left:"+this.paddingH+"px; top:"+this.paddingV+"px; width:"+(this.slideWidth-2*this.paddingH)+"px; height:"+(this.slideHeight-2*this.paddingV)+"px;}.nmdrAL_thumbView {position:absolute; left:0px; top:0px;background-color:#000;}.nmdrAL_thumbItem: {vertical-align:top;height:"+this.slideHeight+"px;background-color:#000;}.nmdrAL_thumbItem:hover {cursor:pointer;border:1px;border-style:solid;border-color:#000;}.nmdrAL_thumbImg {-moz-box-shadow: 5px 5px 5px #ddd; -webkit-box-shadow: 5px 5px 5px #ddd; box-shadow: 5px 5px 5px #ddd; opacity:0.7;}.nmdrAL_thumbImg:hover {opacity:1;}</style>",s=[],n=0,d=this.firstThumb;d<t.thumbs.length;d++)s.push("<div class='nmdrAL_thumbItem' id='"+this.id+"_thumb"+d+"' style='display:inline; position:absolute; left:"+n+"px; top:0px; width:"+this.tviewWidth+"px; height:"+(this.slideHeight-2*this.paddingV)+"px;'><img class='nmdrAL_thumbImg' id='"+this.id+"_img"+d+"' src='"+t.thumbsPath+t.thumbs[d]+"' width='"+this.thumbWidth+"' height='"+this.thumbHeight+"' onclick=\"nmdr.core.$('"+this.id+"').showImage(true, this,"+i+","+d+')"></div>'),n+=this.tviewWidth+this.paddingH;return e+"<div class='nmdrAL_slidesShow' id='"+this.id+"_nmdrAL_slidesShow' style='position:absolute;left:"+(this.albumWidth-this.slideWidth)/2+"px;width:"+this.slideWidth+"px;height:"+this.slideHeight+"px;background:#000;border:1px;border-style:solid;border-color:lightgray;'><div class='nmdrAL_thumbArea' id='"+this.id+"_nmdrAL_thumArea'><div class='nmdrAL_thumbView' id='"+this.id+"_nmdrAL_thumbView'>"+s.join("")+"</div></div>"},i.showImage=function(t,i,e,s){if(!this.animation){var n=document.getElementById(this.id+"_nmdrAL_divOverlay"),d=document.getElementById(this.id+"_nmdrAL_divFrame"),h=document.getElementById(this.id+"_nmdrAL_showdivImage"),l=document.getElementById(this.id+"_nmdrAL_showdivSpan"),o=document.getElementById(this.id+"_nmdrAL_showdivPrev"),r=this;if(document.getElementById(this.id+"_nmdrAL_showdivNext").style.display="none",o.style.display="none",l.innerHTML="",t){nmdr.core.popup.open(d,i,null,function(t){r.showImage(!1),t&&t()}),this.currentTile=e,this.currentThumb=s,d.style.opacity=.5,h.src=this.imagePath+"loading.gif";var a=nmdr.core.utils.calculateWindowSize(),m=nmdr.core.utils.calculateScroll();n.style.width=a.width+m.left-18+"px",n.style.height=a.height+m.top+"px",n.style.display="inline",d.style.top=Math.floor((window.innerHeight-200)/2+m.top)+"px",d.style.left=Math.floor((window.innerWidth-200)/2+m.left)+"px",d.style.height="200px",d.style.width="200px",d.style.display="inline";var u=new Image;u.onload=function(){h.src=this.src,d.style.opacity=1,d.style.top=Math.floor((window.innerHeight-this.height-40)/2+m[1])+"px",d.style.left=Math.floor((window.innerWidth-this.width)/2+m[0])+"px",d.style.height=this.height+40+"px",d.style.width=this.width+"px",r.animation=!0,nmdr.core.animate.fadeIn(null,d,null,!1,function(){l.innerHTML="<b>"+r.albums[r.currentTile].title+"</b><br>Image "+(r.currentThumb+1)+" of "+r.albums[r.currentTile].thumbs.length,r.animation=!1,r.imageOpened=!0})},u.src=this.albums[r.currentTile].imagePath+this.albums[this.currentTile].thumbs[this.currentThumb]}else this.animation=!0,nmdr.core.animate.fadeOut(null,d,null,!1,function(){h.src=r.imagePath+"loading.gif",d.style.top="0px",d.style.left="0px",d.style.height="1px",d.style.width="1px",d.style.display="none",n.style.display="none",r.animation=!1,r.imageOpened=!1}),nmdr.core.popup.close()}},i.showNaviButtons=function(t,i){var e=document.getElementById(this.id+"_nmdrAL_divFrame"),s=document.getElementById(this.id+"_nmdrAL_showdivPrev"),n=document.getElementById(this.id+"_nmdrAL_showdivNext");s.style.display="none",n.style.display="none",i&&(t.clientX<e.offsetLeft+e.offsetWidth/2?this.currentThumb>0&&(s.style.display="inline",s.style.top=e.offsetHeight/2-20+"px",s.style.left="0px"):this.currentThumb<this.albums[this.currentTile].thumbs.length-1&&(n.style.display="inline",n.style.top=e.offsetHeight/2-20+"px",n.style.left=t.target.offsetWidth-64+"px")),nmdr.core.utils.stopPropagation(t)},i.changeImage=function(t){if(!this.animation){var i=document.getElementById(this.id+"_nmdrAL_divFrame"),e=t.clientX<i.offsetLeft+i.offsetWidth/2?this.currentThumb>0?-1:0:this.currentThumb<this.albums[this.currentTile].thumbs.length-1?1:0;0!=e&&this.showImage(!0,t,this.currentTile,this.currentThumb+e)}},i.startLink=function(t){alert(t)},i.createTestAlbum=function(){return[{title:"Animals",description:"These are some pics of animals.",image:"album/animals.jpg",url:"http://www.nalizadeh.com",thumbsPath:"img/album/animals/thumbs/",imagePath:"img/album/animals/",thumbs:["animal1.jpg"]}]},i}