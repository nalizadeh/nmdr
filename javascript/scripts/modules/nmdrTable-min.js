function nmdrTable(e){var t=nmdr.core.$(e,"nmdrTable");if(null!=t){var o=null;return t.columns=[],t.dataRows=[],t.originRows=[],t.selectedRows=[],t.menuCommands=[],t.selectedColumn=-1,t.selectedColumnOld=-1,t.pageNumber=1,t.pageCount=0,t.totalNumber=0,t.firstRow=0,t.lastRow=0,t.clickedRow=-1,t.rowMenuActRow=-1,t.headerMenuOpen=!1,t.rowMenuOpen=!1,t.SORT_ASCENDING="SortZA",t.SORT_DESCENDING="SortAZ",t.props={imagePath:"img/",rowLimit:10,sortingColumn:-1,sortingDirection:null,filters:{},customQuery:null,dataSplitter:",",filterSplitter:"&",menuColumn:-1,clientHandling:!0,doPostBack:!1,multiSelection:!1,showRowCommands:!1,showHeader:!1,showFooter:!1,showBorder:!0,showGrids:!0,showShadow:!1,scrollable:!1,scrollable2:!1,dummyCols:6,dummyRows:6,lang:"en",patternNames:"",removeFilterLable:"",removeSortingLable:"",pageLable:"",ofLable:"",totalLable:"",rowCountLable:"",gotoPageLable:"",color:"#000000",background:"#ffffff",borderColor:"#e0e0e0",borderWidth:"1px",fontFamily:"Arial, Helvetica, sans-serif",fontWidth:"normal",fontSize:"13px",checkSelectionColor:"rgb(0,113,198)",menuCellBackground:"rgb(156, 206, 240)",selcolumnWidth:20,menucolumnWidth:24,headerHeight:24,headerPadding:3,headerWhiteSpace:"nowrap",headerTextOverflow:"ellipsis",headerColor:"#000",headerBackground:"rgb(248, 248, 248)",headerFontFamily:"Arial, Helvetica, sans-serif",headerFontWidth:"bold",headerFontSize:"13px",headerSelectionColor:"rgba(156, 206, 240, 0.5)",headerHOverColor:"#000",headerHOverBackColor:"rgba(205,230,247,0.5)",bodyRowHeight:24,bodyPadding:3,bodyWhiteSpace:"nowrap",bodyTextOverflow:"ellipsis",bodySelectionColor:"#000",bodySelectionBackColor:"rgba(156, 206, 240, 0.5)",bodyHOverColor:"#000",bodyHOverBackColor:"rgba(205,230,247,0.5)",bodyAlternateColor:"rgba(242,246,252,0.5)",footerHeight:42,footerColor:"#000000",footerBackColor:"rgb(248, 248, 248)",footerFontFamily:"Arial, Helvetica, sans-serif",footerFontWidth:"normal",footerFontSize:"12px",footerShowPager:!0,footerShowGoPage:!0,footerShowRowCount:!0,footerShowPageInfo:!0},t.init=function(e){e=e||{},this.props=nmdr.core.utils.mergeProperties(this.props,e),this.localization(),this.loadData(!0,!0)},t.localization=function(){"en"===this.props.lang?(this.props.patternNames=["is equal/x","is not equal/x","contains/x","not contains/x","starts with/x","ends with/x"],this.props.removeFilterLable="Remove Filter",this.props.removeSortingLable="Remove Sorting",this.props.pageLable="Page",this.props.ofLable="of",this.props.totalLable="Total",this.props.rowCountLable="Row count",this.props.gotoPageLable="Go to page"):"de"===this.props.lang?(this.props.patternNames=["is equal/ist gleich","is not equal/ist nicht gleich","contains/enthält","not contains/enthält nicht","starts with/beginnt mit","ends with/endet mit"],this.props.removeFilterLable="Filter löschen",this.props.removeSortingLable="Sortierung löschen",this.props.pageLable="Seite",this.props.ofLable="von",this.props.totalLable="Total",this.props.rowCountLable="Anzahl Zeilen",this.props.gotoPageLable="Gehe zur Seite"):"fr"===this.props.lang?(this.props.patternNames=["is equal/est le même","is not equal/n'est pas égal","contains/contient","not contains/ne contient pas","starts with/commence par","ends with/se termine par"],this.props.removeFilterLable="Supprimer le filtre",this.props.removeSortingLable="Supprimer le tri",this.props.pageLable="Page",this.props.ofLable="de",this.props.totalLable="Totalement",this.props.rowCountLable="Nombre de lignes",this.props.gotoPageLable="Aller à la page"):"es"===this.props.lang&&(this.props.patternNames=["is equal/es lo mismo","is not equal/no es igual","contains/contiene","not contains/no contiene","starts with/comienza con","ends with/termina con"],this.props.removeFilterLable="Eliminar filtro",this.props.removeSortingLable="Eliminar clasificación",this.props.pageLable="Página",this.props.ofLable="de",this.props.totalLable="Total",this.props.rowCountLable="Numero de lineas",this.props.gotoPageLable="Ir a la página")},t.renderHeaderCell=function(e,t){return null},t.renderBodyCell=function(e,t,o,s){return null},t.getColumnWidth=function(e){return null},t.handleEvents=function(e){},t.openRow=function(e){alert("open row: "+e)},t.editRow=function(e){alert("edit row: "+e)},t.deleteRow=function(e){alert("delete row: "+e)},t.makeView=function(){var e=[],t=this.props,o="#"+this.id,s="<style type='text/css'>"+o+" { position: relative !important; width: 100%; height: 100%; box-sizing: border-box; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; -ms-box-sizing: border-box; -o-box-sizing: border-box;}"+o+" .nmdrTB_content { overflow: hidden; color:"+t.color+"; background:"+t.background+"; font-family: "+t.fontFamily+"; font-weight: "+t.fontWidth+"; font-size: "+t.fontSize+"; border-width:"+(t.showBorder?t.borderWidth:"0px")+"; border-color:"+t.borderColor+"; border-style: solid; cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -o-user-select: none;  user-select: none;"+(t.showShadow?"box-shadow:3px 3px 3px #ccc;":"")+"}"+o+" .nmdrTB_table { border-collapse: collapse; }"+o+" .nmdrTB_table td.nmdrTB_body_td { vertical-align: middle; }"+o+" .nmdrTB_table img { vertical-align: middle; cursor: pointer; }"+o+" .nmdrTB_header { background: "+t.headerSelectionColor+"; height: "+t.headerHeight+"px; }"+o+" .nmdrTB_header_tr {}"+o+" .nmdrTB_header_th { height: "+t.headerHeight+"px; color: "+t.headerColor+"; background: linear-gradient(#eee, "+t.headerBackground+"); font-family: "+t.headerFontFamily+"; font-weight: "+t.headerFontWidth+"; font-size: "+t.headerFontSize+"; border-bottom-width:"+(t.showBorder||t.showGrids?t.borderWidth:"0px")+"; border-bottom-color:"+t.borderColor+"; border-bottom-style: solid; padding: "+t.headerPadding+"px; padding-top: "+(t.headerPadding+1)+"px; text-align: left; white-space: "+t.headerWhiteSpace+"; text-overflow: "+t.headerTextOverflow+"; overflow: hidden;}"+o+" .nmdrTB_header_tr th.nmdrTB_header_th:not(:first-child) {  border-left: "+(t.showGrids?t.borderWidth:"0px")+" solid "+t.borderColor+";}"+o+" .nmdrTB_header_th:hover { color: "+t.headerHOverColor+"; background: "+t.headerHOverBackColor+"; transition:all 0.5s ease-in-out;}"+o+" .nmdrTB_header_th_sp:hover { cursor: pointer; }"+o+" .nmdrTB_header_th_se { width:"+t.selcolumnWidth+"px; text-align:center; }"+o+" .nmdrTB_header_th_cm { width:"+t.menucolumnWidth+"px; text-align:center; }"+o+" .nmdrTB_header_th_cm img { opacity: 0.3; }"+o+" .nmdrTB_body_tr { height: "+t.bodyRowHeight+"px; }"+o+" .nmdrTB_body_td { height: "+t.bodyRowHeight+"px; padding: "+t.bodyPadding+"px; white-space: "+t.bodyWhiteSpace+"; text-overflow: "+t.bodyTextOverflow+"; overflow: hidden;}"+o+" .nmdrTB_body_tr:nth-child(even) { background: "+t.bodyAlternateColor+"; }"+o+" .nmdrTB_body_tr:nth-child(odd) { background: "+t.background+"}"+o+" .nmdrTB_body_tr:hover { color: "+t.bodyHOverColor+"; background: "+t.bodyHOverBackColor+"; }"+o+" .nmdrTB_body_tr:hover td.nmdrTB_body_td:first-child { background: "+t.bodyHOverBackColor+"; }"+o+" .nmdrTB_body_tr td.nmdrTB_body_td:not(:first-child) { border-left: "+(t.showGrids?t.borderWidth:"0px")+" solid "+t.borderColor+";}"+o+" .nmdrTB_body_tr td.nmdrTB_body_td { border-bottom: "+(t.showGrids?t.borderWidth:"0px")+" solid "+t.borderColor+";}"+o+" .nmdrTB_body_tr td.nmdrTB_body_td a.nmdrTB_rowcontrol { visibility: hidden; float:right; }"+o+" .nmdrTB_body_tr_sel td.nmdrTB_body_td a.nmdrTB_rowcontrol { visibility: hidden; float:right; }"+o+" .nmdrTB_body_tr:hover td.nmdrTB_body_td a.nmdrTB_rowcontrol { visibility: visible; opacity: 0.3; }"+o+" .nmdrTB_body_tr:hover td.nmdrTB_body_td:first-child img:first-of-type { visibility: visible; }"+o+" .nmdrTB_body_tr:hover .nmdrTB_body_cm { visibility: visible; opacity: 0.3; }"+o+" .nmdrTB_body_tr_sel { color: "+t.bodySelectionColor+"; background: "+t.bodySelectionBackColor+"; }"+o+" .nmdrTB_body_tr_sel td.nmdrTB_body_td:not(:first-child) { border-left: "+(t.showGrids?t.borderWidth:"0px")+" solid "+t.borderColor+";}"+o+" .nmdrTB_body_tr_sel td.nmdrTB_body_td { border-bottom: "+(t.showGrids?t.borderWidth:"0px")+" solid "+t.borderColor+";}"+o+" .nmdrTB_body_tr_sel:hover td.nmdrTB_body_td a.nmdrTB_rowcontrol { visibility: visible !important; opacity: 1 !important;}"+o+" .nmdrTB_body_td_se { width:"+t.selcolumnWidth+"px; min-width:"+t.selcolumnWidth+"px; max-width:"+t.selcolumnWidth+"px; text-align:center;}"+o+" .nmdrTB_body_td_se_sel { background: "+t.checkSelectionColor+"; }"+o+" .nmdrTB_body_se { visibility: hidden; }"+o+" .nmdrTB_body_se_sel { visibility: visible; }"+o+" .nmdrTB_body_td_cm { width:"+t.menucolumnWidth+"px; min-width:"+t.menucolumnWidth+"px; max-width:"+t.menucolumnWidth+"px; text-align:center;}"+o+" .nmdrTB_body_td_cm_sel { background: "+t.menuCellBackground+"; }"+o+" .nmdrTB_body_cm { visibility: hidden; }"+o+" .nmdrTB_body_cm_sel { visibility: visible; }"+o+" .nmdrTB_footer {}"+o+" .nmdrTB_footer_tr {}"+o+" .nmdrTB_footer_td { padding: 0px; }"+o+" .nmdrTB_footer_div { width: 100%; height: "+t.footerHeight+"px; color: "+t.footerColor+"; background: linear-gradient(#eee, "+t.footerBackColor+"); font-family: "+t.footerFontFamily+"; font-weight: "+t.footerFontWidth+"; font-size: "+t.footerFontSize+"; border-top-width: "+(t.showBorder&&!t.showGrids?t.borderWidth:t.scrollable?"1px":"0px")+"; border-top-color: "+t.borderColor+"; border-top-style: solid;}"+o+" .nmdrTB_headerMenu { display: none; background-color: white; border: 1px solid #bbb; padding:10px; line-height: 22px; font-family: arial,verdana,sans-serif; font-weight: normal; font-size:12px; z-index: 999; box-shadow:5px 5px 5px #ddd; transition:all 0.5s ease-in-out;}"+o+" .nmdrTB_rowMenu { display: none; background-color: white; border: 1px solid #bbb; padding: 5px; width: 200px; line-height: 22px; font-family: arial,verdana,sans-serif; font-weight: normal; font-size:12px; z-index: 999; box-shadow:5px 5px 5px #ddd; transition:all 0.5s ease-in-out;}"+o+" .nmdrTB_rowMenu img { vertical-align: middle; }"+o+" .nmdrTB_rowMenu_tr { height:28px; }"+o+" .rowMenuActRow, .nmdrTB_rowMenu_tr:hover {  background: "+t.bodyHOverBackColor+" !important;  cursor: pointer;}"+o+' .nmdrTB_loader { position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; display: none; cursor: wait; z-index: 999; background:#ffffff url("'+t.imagePath+'spLoader.gif") no-repeat center center; opacity: 0.75; filter: alpha(opacity=75);}'+(t.scrollable?o+" .nmdrTB_header_tr { display: block; }"+o+" .nmdrTB_body { display: block; overflow-y: scroll; overflow-x:hidden; height: "+(this.offsetHeight-t.headerHeight-t.footerHeight)+"px; }":o+" .nmdrTB_content {"+(t.scrollable2?"position:absolute; left:0px; top:0px; width:100%; height:100%; overflow-y:scroll;}":"}"))+"</style>";e.push(s),e.push("<script type='text/javascript'>(function() { })();<\/script>"),e.push(this.makeRowMenu()),e.push(this.makeHeaderMenu()),e.push(this.makeContent()),document.getElementById(this.id).innerHTML=e.join(""),this.configSize(),this.initKeyEvents()},t.makeContent=function(){var e=[];return e.push("<div class='nmdrTB_loader'></div>"),e.push("<div class='nmdrTB_content' tabindex='1'>"),e.push(this.makeTable()),e.push("</div>"),e.join("")},t.makeTable=function(){var e=[];return e.push("<table class='nmdrTB_table' border='0' cellpadding='0' cellspacing='0' onselectstart='return false' ondragstart='return false'>"),e.push(this.makeHeader()),e.push(this.makeBody()),e.push(this.makeFooter()),e.push("</table>"),e.join("")},t.makeHeader=function(){if(!this.props.showHeader)return"";var e=0,t=[];t.push("<thead class='nmdrTB_header'>"),t.push("<tr class='nmdrTB_header_tr'>");for(var o=0;o<this.columns.length;o++){0==o&&(t.push("<th class='nmdrTB_header_th nmdrTB_header_th_se'><img src='"+this.props.imagePath+"spCheck.png' "),t.push("onClick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'selectAll');\"></th>"),e+=this.props.selcolumnWidth),o+1==this.props.menuColumn&&(t.push("<th class='nmdrTB_header_th nmdrTB_header_th_cm'><img src='"+this.props.imagePath+"spCMenu.gif'></th>"),e+=this.props.menucolumnWidth);var s=this.getColumnWidth(o),i=this.props.sortingColumn==o?"<img src='"+this.props.imagePath+"sp"+this.props.sortingDirection+".png'":"",r=null!=this.props.filters[o]?"<img src='"+this.props.imagePath+"spFilter.png'>":"",n=this.renderHeaderCell(o,this.columns[o]);t.push("<th class='nmdrTB_header_th' id='"+this.id+"_nmdrTB_header_th"+o+"' "),t.push(s?"style='width:"+s+"px; min-width:"+s+"px; max-width:"+s+"px;'":""),t.push("onmouseOver=\"nmdr.core.$('"+this.id+"').selectHeader("+o+', true);" '),t.push("onmouseOut=\"nmdr.core.$('"+this.id+"').selectHeader("+o+', false);" '),t.push("onclick=\"nmdr.core.$('"+this.id+"').selectColumn(event, "+o+');">'),t.push("<table width=100% border='0' cellpadding='0' cellspacing='0'><tr>"),t.push("<td style='padding:0px 0px 0px 0px;'><table border='0' cellpadding='0' cellspacing='0'><tr>"),t.push("<td style='padding:0px 0px 0px 0px;'><span class='nmdrTB_header_th_sp' onClick=\"nmdr.core.$('"+this.id+"').sortColumn("+o+');">'+(n||this.columns[o])+"</span></td>"),t.push("<td style='width:20px; padding:0px 0px 0px 4px;'>"+i+"</td>"),t.push("<td style='width:16px; padding:0px 0px 0px 0px;'>"+r+"</td></tr></table></td>"),t.push("<td style='width:16px; padding:0px 4px 0px 0px; float:right;'>"),t.push("<img id='"+this.id+"_nmdrTB_hdm"+o+"' src='"+this.props.imagePath+"spMenu.png' "),t.push("onclick=\"nmdr.core.$('"+this.id+"').openHeaderMenu(event, this);\" style='visibility:hidden'></td>"),t.push("</tr></table></th>"),e+=s||0}return t.push("</tr></thead>"),t.join("")},t.makeBody=function(){var e=[];if(e.push("<tbody class='nmdrTB_body'>"),this.dataRows.length>0)for(var t=this.props.clientHandling?this.firstRow:1,o=this.props.clientHandling?this.lastRow:this.props.rowLimit>this.totalNumber?this.totalNumber:this.props.rowLimit,s=t;s<=o;s++){var i=this.dataRows[s-1].split(this.props.dataSplitter),r=-1!=this.selectedRows.indexOf(s);e.push("<tr class='nmdrTB_body_tr"+(r?"_sel":"")+"' id='"+this.id+"_nmdrTB_body_tr"+s+"' "),e.push("onClick=\"nmdr.core.$('"+this.id+"').selectRows(event, "+s+');">');for(var n=0;n<i.length;n++){0==n&&(e.push("<td class='nmdrTB_body_td nmdrTB_body_td_se'>"),e.push("<img class='nmdrTB_body_se' src='"+this.props.imagePath+"spCheckSel.png'></td>")),n+1==this.props.menuColumn&&(e.push("<td class='nmdrTB_body_td nmdrTB_body_td_cm'>"),e.push("<img class='nmdrTB_body_cm' src='"+this.props.imagePath+"spCMenu.gif' "),e.push("onClick=\"nmdr.core.$('"+this.id+"').openRowMenu(event, "+s+');"></td>'));var l=this.getColumnWidth(n),d=this.renderBodyCell(s-1,n,i[n],r),a=this.props.showRowCommands&&n==i.length-1?"<table width='100%' height='100%' border='0' cellpadding='0' cellspacing='0'><tr><td style='vertical-align: middle;'>"+(d||i[n])+"</td><td style='text-alignment: right;'><a class='nmdrTB_rowcontrol'><img src='"+this.props.imagePath+"spOpen.gif' title='open row' onclick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'openRow', "+s+");\">&nbsp;<img src='"+this.props.imagePath+"spEdit.gif' title='edit row' onclick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'editRow', "+s+");\">&nbsp;<img src='"+this.props.imagePath+"spDelete.gif' title='delete row' onclick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'deleteRow', "+s+');">&nbsp;</a></td></tr></table>':null;this.props.scrollable&&l&&n==i.length-1&&(l-=18),e.push("<td class='nmdrTB_body_td'"),e.push(l?" style='width:"+l+"px; min-width:"+l+"px; max-width:"+l+"px;'>":">"),e.push(a||(d||i[n]+"</td>"))}e.push("</tr>")}return e.push("</tbody>"),e.join("")},t.makeFooter=function(){if(!this.props.showFooter)return"";var e=[],t=this.columns.length+(-1==this.props.menuColumn?1:2);return e.push("<tfoot class='nmdrTB_footer'>"),e.push("<tr class='nmdrTB_footer_tr'>"),e.push("<td class='nmdrTB_footer_td' colspan="+t+">"),e.push("<div class='nmdrTB_footer_div'>"+this.renderFooter()+"</div>"),e.push("</td></tr></tfoot>"),e.join("")},t.renderFooter=function(){var e=[];if(e.push("<table width='100%' height='100%' border='0' cellpadding='4px' cellspacing='0'><tr>"),this.props.footerShowPager)if(this.dataRows.length>0){var t=this.firstRow>1?"<img src='"+this.props.imagePath+"spPrevend.gif' onClick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'firstPage');\"":"<img src='"+this.props.imagePath+"spPrevenddis.gif'",o=this.firstRow>1?"<img src='"+this.props.imagePath+"spPrev.gif' onClick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'prevPage');\"":"<img src='"+this.props.imagePath+"spPrevdis.gif'",s=this.lastRow<this.totalNumber?"<img src='"+this.props.imagePath+"spNext.gif' onClick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'nextPage');\"":"<img src='"+this.props.imagePath+"spNextdis.gif'",i=this.lastRow<this.totalNumber?"<img src='"+this.props.imagePath+"spNextend.gif' onClick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'lastPage');\"":"<img src='"+this.props.imagePath+"spNextenddis.gif'";if(e.push("<td><table border='0' cellpadding='0' cellspacing='0'><tr>"),e.push("<td style='padding:0px 0px 0px 10px'>"+t+"'</td>"),e.push("<td style='padding:0px 0px 0px 10px'>"+o+"'</td>"),e.push("<td style='padding:0px 0px 0px 10px'>"+this.firstRow+"-"+this.lastRow+" / "+this.totalNumber+"</td>"),e.push("<td style='padding:0px 0px 0px 10px'>"+s+"'</td>"),e.push("<td style='padding:0px 0px 0px 10px'>"+i+"'</td>"),e.push("</tr></table>"),e.push("<td>"),e.push("<table border='0' cellpadding='0' cellspacing='0' style='margin-right:4px;margin-left:auto;'><tr><td></td>"),this.props.footerShowPageInfo&&e.push("<td style='padding:2px 0px 0px 0px;'><span>"+this.props.pageLable+" <b>"+this.pageNumber+"</b> "+this.props.ofLable+" <b>"+this.pageCount+"</b> / "+this.props.totalLable+" <b>"+this.totalNumber+"</b></span></td>"),this.props.footerShowGoPage){e.push("<td style='padding:2px 0px 0px 10px;'>"+this.props.gotoPageLable),e.push(" <select id='"+this.id+"_nmdrTB_goPageSelect' onchange=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'goToPage');\">"),e.push("<option value=''></option>");for(var r=1;r<=this.pageCount;r++)e.push("<option value='"+r+"'>"+r+"</option>");e.push("</select></td>")}this.props.footerShowRowCount&&(e.push("<td style='padding:2px 0px 0px 10px;'>"+this.props.rowCountLable),e.push(" <select id='"+this.id+"_nmdrTB_rowLimitSelect' onchange=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'setRowLimit');\">"),e.push("<option value='10' "+(10===this.props.rowLimit?"Selected":"")+">10</option>"),e.push("<option value='25' "+(25===this.props.rowLimit?"Selected":"")+">25</option>"),e.push("<option value='50' "+(50===this.props.rowLimit?"Selected":"")+">50</option>"),e.push("<option value='100' "+(100===this.props.rowLimit?"Selected":"")+">100</option>"),e.push("<option value='150' "+(150===this.props.rowLimit?"Selected":"")+">150</option>"),e.push("<option value='200' "+(200===this.props.rowLimit?"Selected":"")+">200</option>"),e.push("</select></td>")),e.push("</tr></table></td>")}else e.push("<td>This view contains no data.</td>");return e.push("</tr></table>"),e.join("")},t.configSize=function(){var e=this.getElementsByClassName("nmdrTB_table")[0];this.props.scrollable?this.style.width=e.offsetWidth+2+"px":e.style.width="100%"},t.updateTable=function(){this.getElementsByClassName("nmdrTB_content")[0].innerHTML=this.makeTable(),this.configSize()},t.loadData=function(e,t){var s=this;this.showLoader(!0),window.setTimeout(function(){var i=s.prepareData();s.columns=i.columns.slice(0),-1!==s.props.menuColumn&&(s.props.menuColumn=Math.max(s.props.menuColumn,1),s.props.menuColumn=Math.min(s.props.menuColumn,s.columns.length)),s.menuCommands=-1!==s.props.menuColumn?s.prepareMenuCommands():[],s.props.rowLimit=Math.min(s.props.rowLimit,i.rows.length),s.props.clientHandling?(o=s,s.originRows=i.rows.slice(0),s.dataRows=s.filterList(),s.dataRows.sort(s.sortComparator)):s.dataRows=i.rows.slice(0),e&&(s.pageNumber=1,s.totalNumber=s.dataRows.length,s.firstRow=1,s.lastRow=s.props.rowLimit>s.totalNumber?s.totalNumber:s.props.rowLimit,s.pageCount=Math.ceil(s.totalNumber/s.props.rowLimit)),t?s.makeView():s.updateTable(),s.showLoader(!1)},10)},t.selectRows=function(e,t,o){if(!o||this.props.multiSelection){if(this.deselect(),o){var s=this.selectedRows.length;if(this.clickedRow=-1,this.selectedRows=[],s!=this.props.rowLimit)for(n=this.firstRow;n<=this.lastRow;n++)this.selectedRows.push(n)}else{var i=this.selectedRows.indexOf(t);if(this.props.multiSelection){if(e&&e.ctrlKey)-1==i?this.selectedRows.push(t):(this.selectedRows.splice(i,1),t=-1);else if(e&&e.shiftKey){if(t<this.selectedRows[0])for(n=t;n<this.selectedRows[0];n++)this.selectedRows.push(n);else if(t>this.selectedRows[this.selectedRows.length-1])for(var r=this.selectedRows[this.selectedRows.length-1],n=t;n>r;n--)this.selectedRows.push(n)}else-1==i||this.selectedRows.length>1?(this.selectedRows=[],this.selectedRows[0]=t):(this.selectedRows=[],t=-1);this.selectedRows.sort(function(e,t){return e-t})}else-1==i?this.selectedRows[0]=t:(this.selectedRows=[],t=-1);this.clickedRow=t}this.select(),this.selectionChanged()}},t.select=function(){var e=this;this.selectedRows.forEach(function(t,o){var s=document.getElementById(e.id+"_nmdrTB_body_tr"+t),i=s.getElementsByClassName("nmdrTB_body_td_se")[0],r=s.getElementsByClassName("nmdrTB_body_se")[0],n=s.getElementsByClassName("nmdrTB_body_td_cm")[0],l=s.getElementsByClassName("nmdrTB_body_cm")[0];s.classList.remove("nmdrTB_body_tr"),s.classList.add("nmdrTB_body_tr_sel"),i.classList.add("nmdrTB_body_td_se_sel"),r.classList.add("nmdrTB_body_se_sel"),n&&(n.classList.add("nmdrTB_body_td_cm_sel"),l.classList.add("nmdrTB_body_cm_sel"))})},t.deselect=function(){var e=this;this.selectedRows.forEach(function(t,o){var s=document.getElementById(e.id+"_nmdrTB_body_tr"+t),i=s.getElementsByClassName("nmdrTB_body_td_se")[0],r=s.getElementsByClassName("nmdrTB_body_se")[0],n=s.getElementsByClassName("nmdrTB_body_td_cm")[0],l=s.getElementsByClassName("nmdrTB_body_cm")[0];s.classList.remove("nmdrTB_body_tr_sel"),s.classList.add("nmdrTB_body_tr"),i.classList.remove("nmdrTB_body_td_se_sel"),r.classList.remove("nmdrTB_body_se_sel"),n&&(n.classList.remove("nmdrTB_body_td_cm_sel"),l.classList.remove("nmdrTB_body_cm_sel"))})},t.clearSelection=function(){this.clickedRow=-1,this.selectedRows=[],this.selectionChanged()},t.selectionChanged=function(){var e=this.getSelection();this.handleEvents(e),this.handlePostBack(e)},t.getSelection=function(){for(var e=[],t=0;t<this.selectedRows.length;t++){var o=this.dataRows[this.selectedRows[t]-1].split(this.props.dataSplitter);e.push(o[0])}return e},t.selectColumn=function(e,t){},t.nextPage=function(){this.clearSelection(),this.pageNumber++,this.firstRow+=this.props.rowLimit,this.lastRow+=this.props.rowLimit,this.firstRow>this.totalNumber&&(this.firstRow=this.lastRow+1),this.lastRow>this.totalNumber&&(this.lastRow=this.totalNumber),this.props.clientHandling?this.updateTable():this.loadData(!1,!1)},t.prevPage=function(){this.pageNumber--,this.firstRow-=this.props.rowLimit,this.lastRow-=this.props.rowLimit,this.firstRow<1&&(this.firstRow=1),this.lastRow<this.firstRow+this.props.rowLimit&&(this.lastRow=this.firstRow+this.props.rowLimit-1),this.clearSelection(),this.props.clientHandling?this.updateTable():this.loadData(!1,!1)},t.firstPage=function(){this.pageNumber=1,this.firstRow=1,this.lastRow=this.props.rowLimit,this.clearSelection(),this.props.clientHandling?this.updateTable():this.loadData(!1,!1)},t.lastPage=function(){var e=this.totalNumber-(this.pageCount-1)*this.props.rowLimit;this.pageNumber=this.pageCount,this.firstRow=this.totalNumber-e,this.lastRow=this.totalNumber,this.clearSelection(),this.props.clientHandling?this.updateTable():this.loadData(!1,!1)},t.sortColumn=function(e){this.props.sortingColumn!=e&&(this.props.sortingDirection=null),this.props.sortingColumn=e,this.props.sortingDirection=null==this.props.sortingDirection?this.SORT_DESCENDING:this.props.sortingDirection==this.SORT_DESCENDING?this.SORT_ASCENDING:this.SORT_DESCENDING,this.clearSelection(),this.doSort()},t.sortAZ=function(){this.props.sortingColumn=this.selectedColumn,this.props.sortingDirection=this.SORT_DESCENDING,this.clearSelection(),this.doSort()},t.sortZA=function(){this.props.sortingColumn=this.selectedColumn,this.props.sortingDirection=this.SORT_ASCENDING,this.clearSelection(),this.doSort()},t.removeSorting=function(){this.props.sortingColumn=-1,this.props.sortingDirection=null,this.clearSelection(),this.doSort()},t.doSort=function(){if(!this.props.clientHandling)return this.loadData(!1,!1);this.showLoader(!0);var e=this;window.setTimeout(function(){-1===e.props.sortingColumn?e.dataRows=e.originRows.slice(0):(o=e,e.dataRows.sort(e.sortComparator)),e.showLoader(!1),e.updateTable()},10)},t.sortComparator=function(e,t){var s=o;if(null==e&&null==t)return 0;if(null!=e&&null==t)return s.props.sortingDirection==s.SORT_DESCENDING?1:-1;if(null==e&&null!=t)return s.props.sortingDirection==s.SORT_DESCENDING?-1:1;var i=e.split(s.props.dataSplitter),r=t.split(s.props.dataSplitter),n=i[s.props.sortingColumn],l=r[s.props.sortingColumn];return n==l?0:n>l?s.props.sortingDirection==s.SORT_DESCENDING?1:-1:s.props.sortingDirection==s.SORT_DESCENDING?-1:1},t.setFilter=function(){var e=document.getElementById(this.id+"_nmdrTB_filterSelect").value,t=document.getElementById(this.id+"_nmdrTB_filterText").value;t.length>0&&(this.props.filters[this.selectedColumn]=e+this.props.filterSplitter+t,this.clearSelection(),this.doFilter())},t.removeFilter=function(){delete this.props.filters[this.selectedColumn],this.clearSelection(),this.doFilter()},t.doFilter=function(){if(!this.props.clientHandling)return this.loadData(!0,!1);this.showLoader(!0);var e=this;window.setTimeout(function(){e.dataRows=e.filterList(),e.pageNumber=1,e.totalNumber=e.dataRows.length,e.firstRow=e.dataRows.length>0?1:0,e.lastRow=e.props.rowLimit<e.totalNumber?e.props.rowLimit:e.totalNumber,e.pageCount=Math.ceil(e.totalNumber/e.props.rowLimit),e.showLoader(!1),e.updateTable()},10)},t.filterList=function(){var e=[];if(Object.keys(this.props.filters).length>0)for(var t in this.originRows){var s=this.originRows[t],i=s.split(this.props.dataSplitter),r=!0;for(var n in i)if(this.props.filters[n]){var l=i[n],d=this.props.filters[n].split(this.props.filterSplitter);switch(d[0]){case"isequal":r&=l===d[1];break;case"isnotequal":r&=l!==d[1];break;case"contains":r&=-1!==l.indexOf(d[1]);break;case"notcontains":r&=-1==l.indexOf(d[1]);break;case"startswith":r&=0==l.indexOf(d[1]);break;case"endswith":r&=-1!==l.indexOf(d[1],l.length-d[1].length)}}r&&e.push(s)}else e=this.originRows.slice(0);return-1!==this.props.sortingColumn&&(o=this,e.sort(this.sortComparator)),e},t.setRowLimit=function(){var e=document.getElementById(this.id+"_nmdrTB_rowLimitSelect").value;this.props.rowLimit=parseInt(e),this.props.clientHandling?(this.pageNumber=1,this.firstRow=this.dataRows.length>0?1:0,this.lastRow=this.props.rowLimit<this.totalNumber?this.props.rowLimit:this.totalNumber,this.pageCount=Math.ceil(this.totalNumber/this.props.rowLimit),this.clearSelection(),this.updateTable()):this.loadData(!0,!1)},t.goToPage=function(){var e=document.getElementById(this.id+"_nmdrTB_goPageSelect").value;e.length&&(this.pageNumber=parseInt(e),this.props.clientHandling?(this.firstRow=(this.pageNumber-1)*this.props.rowLimit+1,this.lastRow=this.firstRow+this.props.rowLimit-1,this.lastRow>this.totalNumber&&(this.lastRow=this.totalNumber),this.clearSelection(),this.updateTable()):this.loadData(!1,!1))},t.openHeaderMenu=function(e,t){var o=this,s=t.id.substring(t.id.indexOf("_hdm")+4),i=document.getElementById(this.id+"_nmdrTB_header_th"+s),r=this.getElementsByClassName("nmdrTB_headerMenu")[0],n=this.absPosition,l=i.absPosition;nmdr.core.utils.stopPropagation(e),l.left+r.offsetWidth>n.left+this.offsetWidth&&(l.left=n.left+this.offsetWidth-r.offsetWidth),r.style.display="inline-block",r.style.position="absolute",r.style.left=l.left-n.left+"px",r.style.top=l.top-n.top+(this.props.headerHeight+8)+"px",nmdr.core.popup.open(r,t,function(){nmdr.core.animate.fadeIn(null,r,null,!0,function(){o.headerMenuOpen=!0})},function(e){o.closeHeaderMenu(null,o,e)}),document.getElementById(this.id+"_nmdrTB_filterColumnName").text=this.columns[s],this.selectedColumnOld=this.selectedColumn,this.selectedColumn=parseInt(s),document.getElementById(this.id+"_nmdrTB_filterSelect").innerHTML=this.makeFilterPattern(!1),document.getElementById(this.id+"_nmdrTB_filterText").value=this.makeFilterPattern(!0),-1!=this.selectedColumnOld&&(document.getElementById(this.id+"_nmdrTB_header_th"+this.selectedColumnOld).style.opacity=1)},t.closeHeaderMenu=function(e,t,o){null==t&&(t=this);var s=t.getElementsByClassName("nmdrTB_headerMenu")[0];nmdr.core.animate.fadeOut(null,s,null,!0,function(){s.style.display="none",document.getElementById(t.id+"_nmdrTB_header_th"+t.selectedColumn).style.opacity=1,t.headerMenuOpen=!1,t.handleCommand(null,e),t.selectedColumn=-1,t.selectedColumnOld=-1,o&&o()}),nmdr.core.popup.close()},t.openRowMenu=function(e,t){var o=this,s=document.getElementById(this.id+"_nmdrTB_body_tr"+t).getElementsByClassName("nmdrTB_body_cm")[0],i=this.getElementsByClassName("nmdrTB_rowMenu")[0],r=this.absPosition,n=s.absPosition;n.left+i.offsetWidth>r.left+this.offsetWidth&&(n.left=this.offsetWidth-i.offsetWidth),i.style.display="inline-block",i.style.position="absolute",i.style.left=n.left-r.left+"px",i.style.top=n.top-r.top+14+"px",nmdr.core.popup.open(i,s,function(){nmdr.core.animate.fadeIn(null,i,null,!0,function(){o.rowMenuOpen=!0})},function(e){o.closeRowMenu("clear",null,o,e)}),(this.clickedRow==t||this.selectedRows.length>1&&-1!=this.selectedRows.indexOf(t))&&nmdr.utils.stopPropagation(e)},t.closeRowMenu=function(e,t,o,s){null==o&&(o=this);var i=o.getElementsByClassName("nmdrTB_rowMenu")[0];nmdr.core.animate.fadeOut(null,i,null,!0,function(){i.style.display="none",o.updateRowMenuRow(!1),o.rowMenuOpen=!1,o.rowMenuActRow=-1,o.handleCommand(null,e),t&&t(),s&&s()}),nmdr.core.popup.close()},t.updateRowMenuRow=function(e){if(-1!=this.rowMenuActRow){var t=document.getElementById(this.id+"_nmdrTB_rowMenu_tr_"+this.rowMenuActRow);e?t.classList.add("rowMenuActRow"):t.classList.remove("rowMenuActRow")}},t.onRowMenuMouseOver=function(e){this.updateRowMenuRow(!1),this.rowMenuActRow},t.selectHeader=function(e,t){var o=document.getElementById(this.id+"_nmdrTB_header_th"+e);if(null==o);var s=document.getElementById(this.id+"_nmdrTB_hdm"+e);o.style.opacity=e==this.selectedColumn?.5:1,s&&(s.style.visibility=t?"visible":"hidden")},t.initKeyEvents=function(){var e=this;document.addEventListener("keydown",function(t){if(nmdr.core.utils.isActiveElement(e))if(40==t.keyCode){if(e.rowMenuOpen)-1!=e.rowMenuActRow?(e.updateRowMenuRow(!1),3==e.rowMenuActRow?e.rowMenuActRow=0:e.rowMenuActRow++):e.rowMenuActRow=0,e.updateRowMenuRow(!0);else{o=0==e.selectedRows.length?0:e.selectedRows[0];if(e.props.scrollable){s=e.getElementsByClassName("nmdrTB_body")[0];o<e.lastRow&&(s.scrollTop+=e.props.bodyRowHeight+7,e.selectRows(null,o+1))}else e.selectRows(null,o==e.lastRow?e.firstRow:o+1)}nmdr.core.utils.stopPropagation(t)}else if(38==t.keyCode){if(e.rowMenuOpen)-1!=e.rowMenuActRow?(e.updateRowMenuRow(!1),0==e.rowMenuActRow?e.rowMenuActRow=3:e.rowMenuActRow--):e.rowMenuActRow=0,e.updateRowMenuRow(!0);else{var o=0==e.selectedRows.length?0:e.selectedRows[0];if(e.props.scrollable){var s=e.getElementsByClassName("nmdrTB_body")[0];o>e.firstRow&&(s.scrollTop-=e.props.bodyRowHeight+7,e.selectRows(null,o-1))}else e.selectRows(null,o==e.firstRow?e.lastRow:o-1)}nmdr.core.utils.stopPropagation(t)}else 33==t.keyCode?nmdr.core.utils.stopPropagation(t):34==t.keyCode?nmdr.core.utils.stopPropagation(t):13==t.keyCode&&(e.rowMenuOpen?e.executeMenuCommand(e.rowMenuActRow):-1!=e.props.menuColumn&&e.openRowMenu(t,e.selectedRows[0]),nmdr.core.utils.stopPropagation(t))})},t.showLoader=function(e){var t=this.getElementsByClassName("nmdrTB_loader")[0];t&&(t.style.display=e?"inline":"none",t.style.cursor=e?"wait":"default")},t.handleCommand=function(e,t,o){if(this.headerMenuOpen)this.closeHeaderMenu(t);else if(this.rowMenuOpen)this.closeRowMenu(t);else switch(e&&nmdr.core.utils.stopPropagation(e),o&&this.selectRows(e,o),t){case"selectAll":this.selectRows(null,null,!0);break;case"nextPage":this.nextPage();break;case"prevPage":this.prevPage();break;case"firstPage":this.firstPage();break;case"lastPage":this.lastPage();break;case"sortAZ":this.sortAZ();break;case"sortZA":this.sortZA();break;case"removeSorting":this.removeSorting();break;case"setFilter":this.setFilter();break;case"removeFilter":this.removeFilter();break;case"setRowLimit":this.setRowLimit();break;case"goToPage":this.goToPage();break;case"openRow":this.openRow(o);break;case"editRow":this.editRow(o);break;case"deleteRow":this.deleteRow(o)}},t.executeMenuCommand=function(e){this.closeRowMenu("clear",this.menuCommands[e].action)},t.handlePostBack=function(e){this.props.doPostBack},t.makeFilterPattern=function(e){if(e)return this.props.filters[this.selectedColumn]?this.props.filters[this.selectedColumn].split(this.props.filterSplitter)[1]:"";var t="",o=this.props.filters[this.selectedColumn]?this.props.filters[this.selectedColumn].split(this.props.filterSplitter)[0]:"";for(var s in this.props.patternNames){var i=this.props.patternNames[s].split("/");switch(i[0]){case"is equal":t+="<option value='isequal' "+("isequal"==o?"selected":"")+">"+("x"==i[1]?i[0]:i[1])+"</option>";break;case"is not equal":t+="<option value='isnotequal' "+("isnotequal"==o?"selected":"")+">"+("x"==i[1]?i[0]:i[1])+"</option>";break;case"contains":t+="<option value='contains' "+("contains"==o?"selected":"")+">"+("x"==i[1]?i[0]:i[1])+"</option>";break;case"not contains":t+="<option value='notcontains' "+("notcontains"==o?"selected":"")+">"+("x"==i[1]?i[0]:i[1])+"</option>";break;case"starts with":t+="<option value='startswith' "+("startswith"==o?"selected":"")+">"+("x"==i[1]?i[0]:i[1])+"</option>";break;case"ends with":t+="<option value='endswith' "+("endswith"==o?"selected":"")+">"+("x"==i[1]?i[0]:i[1])+"</option>"}}return t},t.makeRowMenu=function(){if(-1===this.props.menuColumn)return"";var e=[];e.push("<div class='nmdrTB_rowMenu' id='"+this.id+"_nmdrTB_rowMenu'>"),e.push("<table cellpadding='0' cellspacing='0' border='0' width='100%' height='100%'>");for(var t=0;t<this.menuCommands.length;t++){var o=this.menuCommands[t];e.push("<tr class='nmdrTB_rowMenu_tr' id='"+this.id+"_nmdrTB_rowMenu_tr_"+t+"' "),e.push("onclick=\"nmdr.core.$('"+this.id+"').executeMenuCommand("+t+');" '),e.push("onmouseover=\"nmdr.core.$('"+this.id+"').onRowMenuMouseOver(event);\">"),e.push("<td style='width:24px'><img src='"+this.props.imagePath+o.icon+"'></td>"),e.push("<td><span>"+o.name+"</span></td>"),e.push("</tr>")}return e.push("</table></div>"),e.join("")},t.makeHeaderMenu=function(){var e=[];return e.push("<div class='nmdrTB_headerMenu'>"),e.push("<table cellpadding='0' cellspacing='0' border='0' width='100%' height='100%'>"),e.push("<tr>"),e.push("<td>"),e.push("<a href='#'><img src='"+this.props.imagePath+"spDoSortAZ.gif' style='border-style:none;'/></a>"),e.push("<a href='' onClick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'sortAZ');\" style='text-decoration:none;'>A-Z</a>"),e.push("</td>"),e.push("<td>"),e.push("<a href='' onClick=\"nmdr.core.$('"+this.id+"').handleCommand(event);\">"),e.push("<img src='"+this.props.imagePath+"spClosePopup.gif' style='border-style:none; vertical-align:middle;float:right;'/>"),e.push("</a>"),e.push("</td>"),e.push("</tr>"),e.push("<tr>"),e.push("<td colspan='2'>"),e.push("<a href='#'><img src='"+this.props.imagePath+"spDoSortZA.gif' style='border-style:none;'/></a>"),e.push("<a href='' onClick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'sortZA');\" style='text-decoration:none;'>Z-A</a>"),e.push("</td>"),e.push("</tr>"),e.push("<tr>"),e.push("<td colspan='2' style='border-bottom:dotted; border-bottom-width:1px;'></td>"),e.push("</tr>"),e.push("<tr>"),e.push("<td colspan='2'>"),e.push("<a href='#'><img src='"+this.props.imagePath+"spFilterdel.gif' style='border-style:none;'/></a>"),e.push("<a href='' onClick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'removeFilter');\" style='text-decoration:none;'>"+this.props.removeFilterLable+"&nbsp;&nbsp;</a>"),e.push("<a href='#'><img src='"+this.props.imagePath+"spSortdel.gif' style='border-style:none;'/></a>"),e.push("<a href='' onClick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'removeSorting');\" style='text-decoration:none;'>"+this.props.removeSortingLable+"</a>"),e.push("</td>"),e.push("</tr>"),e.push("<tr>"),e.push("<td colspan='2'>"),e.push("<table>"),e.push("<tr>"),e.push("<td>"),e.push("<span id='"+this.id+"_nmdrTB_filterColumnName'>Column</span>"),e.push("</td>"),e.push("<td>"),e.push("<select id='"+this.id+"_nmdrTB_filterSelect'>"+this.makeFilterPattern(!1)+"</select>"),e.push("</td>"),e.push("<td>"),e.push("<input id='"+this.id+"_nmdrTB_filterText' type='text' name='columnfilter' size='10' value='"+this.makeFilterPattern(!0)+"'/>"),e.push("</td>"),e.push("<td>"),e.push("<a href='' onClick=\"nmdr.core.$('"+this.id+"').handleCommand(event, 'setFilter');\">"),e.push("<img src='"+this.props.imagePath+"spFilterset.gif' style='border-style:none; vertical-align:middle;'/>"),e.push("</a>"),e.push("</td>"),e.push("</tr>"),e.push("</table>"),e.push("</td>"),e.push("</tr>"),e.push("</table>"),e.push("</div>"),e.join("")},t.prepareMenuCommands=function(){return[{name:"open item",icon:"details.gif",action:function(){alert("open item")}},{name:"edit item",icon:"editdetails.gif",action:function(){alert("edit item")}},{name:"delete item",icon:"delete.gif",action:function(){alert("delete item")}},{name:"rename item",icon:"edititem.gif",action:function(){alert("rename item")}}]},t.prepareData=function(){for(var e=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t=this.props.dataSplitter,o=[],s=[],i=0;i<this.props.dummyRows;i++){for(var r="",n=0;n<this.props.dummyCols;n++)n<e.length&&(0==i&&o.push(e[n]),r+=e[n]+i,n<this.props.dummyCols-1&&(r+=t));s.push(r)}return{columns:o,rows:s}},t}}