function nmdrRibbon(t){var e=nmdr.core.$(t,"nmdrRibbon");if(null!=e)return e.imagePath="img/",e.lang="en",e.color="#666",e.background="#F7F3F7",e.backgroundImage="ribbonBackground.png",e.font="normal 11px 'Segoe UI',Tahoma,Verdana,sans-serif",e.height=32,e.buttonWidth=62,e.isOpen=!1,e.isMenuOpen=!1,e.isComboOpen=!1,e.selectedButton=null,e.tabs=[],e.build=function(t,e,i){null==t&&(t=this.prepareTestRibbon()),e&&(this.lang=e),i&&(this.imagePath=i+"/"),this.readFromXML(t);var o="#"+this.id+"_nmdrRB",n="<style>#"+this.id+" { position:relative !important; }"+o+" { position:absolute; width:100%; height:"+this.height+"px; top:0px; left:0px; margin:0; padding:0; font:"+this.font+"; color:"+this.color+"; background:"+this.background+"; border-bottom:1px solid transparent; -webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none; }"+o+" .navibuttDiv { vertical-align:middle; padding:0 10px 0 10px; cursor:pointer; }"+o+" .tabDiv { height:"+(this.height-3)+"px; line-height:"+(this.height-3)+"px; vertical-align:middle;  border:1px solid transparent; border-top:3px solid transparent; }"+o+" .tabDivText { height:"+(this.height-3)+"px; padding:0px 10px 0px 10px; background:"+this.background+"; }"+o+" .tabDivText:hover { cursor:pointer; color:orange !important; background:#fff !important; }"+o+" .tabDivSelected .tabDivText { background:#fff; }"+o+" .tabDivIngroup .tabDivText { background:#eee; }"+o+" .containerDiv { vertical-align:top; padding:0; margin:0; display:none; z-index:998; font-size:11px; color:#23272c; line-height:1em;border-bottom:1px solid transparent; border-top:none; background-image:url("+this.imagePath+this.backgroundImage+") !important;background-repeat:no-repeat; background:#fff; }"+o+" .groupDiv { vertical-align:top; padding:2px 4px 0px 4px; height:88px; border-right:1px solid #ccc; }"+o+" .buttonDiv { vertical-align:top; padding:4px 0px 0px 0px; height:68px; overflow:hidden; border:1px solid transparent; }"+o+" .buttonDivtd { text-align:center; vertical-align:top; text-overflow:ellipsis; white-space:normal; }"+o+" .buttonDiv:hover { cursor:pointer; border:1px solid orange; background-image:url("+this.imagePath+"ribbonButtonHover.png) !important;background-repeat:repeat; }"+o+" .smallbuttonsDiv { vertical-align:top; padding:4px 0px 0px 0px; height:68px; overflow:hidden; border:1px solid transparent; }"+o+" .smallbuttonDiv { height:20px; padding:2px 2px 0px 2px;}"+o+" .smallbuttonDiv:hover { cursor:pointer; background-image:url("+this.imagePath+"ribbonButtonHover.png) !important;background-repeat:repeat; }"+o+" .checkboxesDiv { vertical-align:top; padding:4px 0px 0px 0px; height:68px; overflow:hidden; border:1px solid transparent; }"+o+" .checkboxDiv { padding:0px 2px 0px 2px; }"+o+" .checkboxDiv:hover { cursor:pointer; background-image:url("+this.imagePath+"ribbonMItemHover.png) !important;background-repeat:repeat; }"+o+" .radiobuttonsDiv { vertical-align:top; padding:4px 0px 0px 0px; height:68px; overflow:hidden; border:1px solid transparent; }"+o+" .radiobuttonDiv { padding:0px 2px 0px 2px; }"+o+" .radiobuttonDiv:hover { cursor:pointer; background-image:url("+this.imagePath+"ribbonMItemHover.png) !important;background-repeat:repeat; }"+o+" .comboboxesDiv { vertical-align:top; padding:4px 0px 0px 0px; height:68px; overflow:hidden; border:1px solid transparent; }"+o+" .comboboxDiv { padding:0px 2px 0px 2px; border:1px solid #ccc; background:#fff; }"+o+" .comboboxDiv:hover { cursor:pointer; border:1px solid orange; }"+o+" .comboitemDiv:hover { cursor:pointer; background-image:url("+this.imagePath+"ribbonMItemHover.png) !important;background-repeat:repeat; }"+o+" .menuitemDiv:hover { cursor:pointer; background-image:url("+this.imagePath+"ribbonMItemHover.png) !important;background-repeat:repeat; }"+o+" .groupnameDiv { height:16px; text-align:center; font-size:11px; color:#666; }"+o+" .itemDisabled { opacity:0.5; cursor:default !important;}"+o+" .popupDiv { background:#fff;padding:4px;border:1px solid #ccc;font-size:11px; z-index:999;}</style>",s=[];s.push("<div id='"+this.id+"_nmdrRB' style='display:inline-block;'>"),s.push("<div class='navibuttDiv' style='display:inline-block;'><img id='"+this.id+"_nmdrRB_naviimg' src='"+this.imagePath+"tabdown.png'></div>");for(var d=0;d<this.tabs.length;d++){var r=this.tabs[d];s.push("<div class='tabDiv' id='"+this.id+"_nmdrRB_tabDiv"+d+"' style='display:inline-block;' onclick=\"nmdr.core.$('"+this.id+"').selectTab("+r.number+");\"><div class='tabDivText' style='display:inline-block;'>"+r.text+"</div></div>")}return s.push("<div id='"+this.id+"_nmdrRB_container' class='containerDiv' style='position:absolute;left:0px;top:0px;width:100%;height:90px;display:none;'></div>"),s.push("<div id='"+this.id+"_nmdrRB_popup' class='popupDiv' style='position:absolute;left:0px;top:0px;width:0px;height:0px;display:none;'></div>"),s.push("<div id='"+this.id+"_nmdrRB_sizeCalculator' style='position:absolute;top:0px;left:0px;visibility:hidden;'></div>"),s.push("</div>"),this.innerHTML=n+s.join(""),this},e.selectTab=function(t){var e=document.getElementById(this.id+"_nmdrRB").getElementsByClassName("tabDiv");if(-1==e[t].className.indexOf("tabDivSelected")){for(o=0;o<e.length;o++)e[o].className="tabDiv",e[o].style.color=this.color,e[o].style.borderColor="transparent";if(0==t)this.isOpen&&(this.closeTab(t),this.isOpen=!1,document.getElementById(this.id+"_nmdrRB").style.borderBottomColor="transparent",document.getElementById(this.id+"_nmdrRB_container").style.borderBottomColor="transparent",document.getElementById(this.id+"_nmdrRB_naviimg").src=this.imagePath+"/tabdown.png");else{var i=this.tabs[t].color;document.getElementById(this.id+"_nmdrRB").style.borderBottomColor=i,document.getElementById(this.id+"_nmdrRB_container").style.borderBottomColor=i,document.getElementById(this.id+"_nmdrRB_naviimg").src=this.imagePath+"/tabup.png",e[t].className+=" tabDivSelected",e[t].style.color=i,e[t].style.borderColor=i,e[t].style.borderBottomColor="#fff";for(var o=0;o<this.tabs.length;o++)o!=t&&this.tabs[o].groupnumber==this.tabs[t].groupnumber&&(i=this.tabs[o].color,e[o].className+=" tabDivIngroup",e[o].style.borderColor=i);this.openTab(t),this.isOpen=!0}}},e.openTab=function(t){var e=this,i=document.getElementById(this.id+"_nmdrRB_container");i.style.left="0px",i.style.top="0px",i.style.opacity=0,this.createTabContent(t),i.style.display="inline",nmdr.core.animate.scrollX(i,0,this.height+1,1,function(){e.tabOpened(t)})},e.closeTab=function(t){var e=this,i=document.getElementById(this.id+"_nmdrRB_container");nmdr.core.animate.scrollX(i,0,-(this.height+1),-1,function(){i.style.display="none",i.style.left="0px",i.style.top="0px",e.tabClosed(t)})},e.tabOpened=function(t){},e.tabClosed=function(t){},e.getItem=function(t){for(var e=function(t,e){for(var i=0;i<e.length;i++)if(e[i].id==t)return e[i]},i=null,o=1;o<this.tabs.length&&null==(i=e(t,this.tabs[o].groups));o++){for(var n=0;n<this.tabs[o].groups.length&&null==(i=e(t,this.tabs[o].groups[n].buttons))&&null==(i=e(t,this.tabs[o].groups[n].checkboxes))&&null==(i=e(t,this.tabs[o].groups[n].radiobuttons))&&null==(i=e(t,this.tabs[o].groups[n].comboboxes));n++);if(null!=i)break}return i},e.actionPerformed=function(t){alert("You started command: "+t)},e.executeCommand=function(t,e){var i=this;if(!this.closePopups(function(){i.executeCommand(t,e)})){var o=this.getItem(e);null!=o&&(o.menu.length>0?this.openMenu(t,o):this.actionPerformed(o.command))}},e.executeMenuCommand=function(t,e){var i=this;this.closeMenu(function(){i.actionPerformed(e)})},e.toggleCheckBox=function(t){var e=this;if(!this.closePopups(function(){e.toggleCheckBox(t)})){var i=this.getItem(t);i.checked=!i.checked;var o=this.imagePath+(i.checked?"/checkboxon.png":"/checkboxoff.png");document.getElementById(this.id+"_nmdrRB_checkboxDiv_"+t+"_img").src=o,i.command&&this.actionPerformed(i.command)}},e.selectRadioButton=function(t,e){var i=this;if(!this.closePopups(function(){i.selectRadioButton(t,e)})){for(var o=this.getItem(t),n=null,s=0;s<o.radiobuttons.length;s++){var d=o.radiobuttons[s];d.selected=d.id==e;var r=this.imagePath+(d.selected?"/radiobutton.png":"/radiobuttoff.png");document.getElementById(this.id+"_nmdrRB_radiobuttonDiv_"+d.id+"_img").src=r,d.selected&&(n=d)}n&&n.command&&this.actionPerformed(n.command)}},e.selectComboBox=function(t,e){var i=this,o=this.getItem(t);o.selected=e,document.getElementById(this.id+"_nmdrRB_comboboxDiv_"+o.id+"_input").innerHTML=e,this.closeComboBox(function(){i.actionPerformed(o.command)})},e.openMenu=function(t,e){var i=this;if(!this.closePopups(function(){i.openMenu(t,e)})){this.isMenuOpen=!0;for(var o=[],n=0;n<e.menu.length;n++){var s=e.menu[n];o.push("<div class='menuitemDiv' style='display:block;' onclick=\"nmdr.core.$('"+this.id+"').executeMenuCommand(event,'"+s.command+"');\"><table cellpadding='2' cellspacing='0' border='0'><tr><td><img src='"+s.image+"' title='"+s.tooltip+"'></td><td style='vertical-align:middle;'><span style='font-size:12px;font-weight:bold;'>"+s.text+"</span><br><span style='font-size:11px;font-weight:normal;'>"+s.description+"</span></td></tr></table></div>")}this.selectedButton=this.id+"_nmdrRB_buttonDiv_"+e.id;var d=document.getElementById(this.id+"_nmdrRB_popup"),r=document.getElementById(this.selectedButton),a=document.getElementById(this.id+"_nmdrRB_sizeCalculator"),l=this.absPosition,c=r.absPosition,p=o.join("");a.innerHTML=p,d.innerHTML=p,r.style.background="url("+this.imagePath+"ribbonButtonHover.png)",d.style.display="inline-block",d.style.top=c.top-l.top+r.offsetHeight+"px",d.style.left=c.left-l.left+"px",d.style.width=a.offsetWidth+4+"px",d.style.height=a.offsetHeight+"px",d.style.opacity=0,a.innerHTML="",nmdr.core.popup.open(d,t.target,null,function(t){i.closeMenu(t)}),nmdr.core.animate.fadeIn(null,d,null,!0),nmdr.core.utils.stopPropagation(t)}},e.closeMenu=function(t){if(this.isMenuOpen){this.isMenuOpen=!1;var e=document.getElementById(this.id+"_nmdrRB_popup"),i=document.getElementById(this.selectedButton);nmdr.core.animate.fadeOut(null,e,null,!0,function(){e.style.display="none",e.style.top="0px",e.style.left="0px",e.style.width="0px",e.style.height="0px",i.style.background="transparent",t&&t()}),nmdr.core.popup.close()}},e.openComboBox=function(t,e){var i=this;if(!this.closePopups(function(){i.openComboBox(t,e)})){this.isComboOpen=!0;for(var o=[],n=this.getItem(e),s=0;s<n.items.length;s++){var d=n.items[s];o.push("<div class='comboitemDiv' style='display:block;' onclick=\"nmdr.core.$('"+this.id+"').selectComboBox('"+e+"','"+d+"');\"><table cellpadding='2' cellspacing='0' border='0'><tr><td style='vertical-align:middle;'>"+d+"</td></tr></table></div>")}var r=document.getElementById(this.id+"_nmdrRB_popup"),a=document.getElementById(this.id+"_nmdrRB_comboboxDiv_"+e),l=document.getElementById(this.id+"_nmdrRB_sizeCalculator"),c=this.absPosition,p=a.absPosition,u=o.join("");l.innerHTML=u,r.innerHTML=u,r.style.display="inline-block",r.style.top=p.top-c.top+a.offsetHeight+"px",r.style.left=p.left-c.left+"px",r.style.width=(l.offsetWidth<n.width?n.width-4:l.offsetWidth)+"px",r.style.height=l.offsetHeight+"px",l.innerHTML="",nmdr.core.popup.open(r,t.target,null,function(t){i.closeComboBox(t)}),nmdr.core.animate.fadeIn(null,r,null,!0),nmdr.core.utils.stopPropagation(t)}},e.closeComboBox=function(t){if(this.isComboOpen){this.isComboOpen=!1;var e=document.getElementById(this.id+"_nmdrRB_popup");nmdr.core.animate.fadeOut(null,e,null,!0,function(){e.style.display="none",e.style.top="0px",e.style.left="0px",e.style.width="0px",e.style.height="0px",t&&t()}),nmdr.core.popup.close()}},e.closePopups=function(t){return this.isMenuOpen?(this.closeMenu(t),!0):!!this.isComboOpen&&(this.closeComboBox(t),!0)},e.enableItem=function(t,e){var i=this.getItem(t);i&&(i.enabled=e)},e.createTabContent=function(t){for(var e=this.tabs[t],i=[],o=0;o<e.groups.length;o++){var n=e.groups[o],s=[];i.push("<div class='groupDiv' style='display:inline-block;'>");for(u=0;u<n.buttons.length;u++)if("16"!=(d=n.buttons[u]).size){r="";d.menu&&d.menu.length>0&&(r="<br><img src='"+this.imagePath+"/menuf.png'>"),i.push("<div class='buttonDiv"+(d.enabled?"'":" itemDisabled'")+"id='"+this.id+"_nmdrRB_buttonDiv_"+d.id+"' style='display:inline-block;'"+(d.enabled?" onclick=\"nmdr.core.$('"+this.id+"').executeCommand(event, '"+d.id+"');\"":"")+"><table cellpadding='2' cellspacing='0' border='0'><tr><td class='buttonDivtd' style='width:"+d.width+"px;'><img src='"+d.image+"' title='"+d.tooltip+"'></td></tr><tr><td class='buttonDivtd' style='width:"+d.width+"px;'>"+d.text+r+"</td></tr></table></div>")}else s.push(d);if(s.length>0){p=0;do{i.push("<div class='smallbuttonsDiv' style='display:inline-block;'>");for(u=0;p<s.length&&!(u>0&&u%3==0);u++,p++){var d=s[p],r="";d.menu&&d.menu.length>0&&(r="&nbsp;<img src='"+this.imagePath+"/menuf.png' onclick=\"nmdr.core.$('"+this.id+"').openMenu(event, "+t+');">'),i.push("<div class='smallbuttonDiv"+(d.enabled?"'":" itemDisabled'")+" id='"+this.id+"_nmdrRB_buttonDiv_"+d.id+"' style='display:block;' "+(d.enabled?"onclick=\"nmdr.core.$('"+this.id+"').executeCommand(event, '"+d.id+"');\"":"")+"><table cellpadding='1' cellspacing='0' border='0'><tr><td><img src='"+d.image+"' title='"+d.tooltip+"'></td><td style='vertical-align:middle;'><span>"+d.text+r+"</span></td></tr></table></div>")}i.push("</div>")}while(p<s.length)}if(n.checkboxes.length>0){p=0;do{i.push("<div class='checkboxesDiv' style='display:inline-block;'>");for(u=0;p<n.checkboxes.length&&!(u>0&&u%3==0);u++,p++){var a=n.checkboxes[p],l=this.imagePath+(a.checked?"/checkboxon.png":"/checkboxoff.png");i.push("<div class='checkboxDiv"+(a.enabled?"'":" itemDisabled'")+" id='"+this.id+"_nmdrRB_checkboxDiv_"+a.id+"' style='display:block;' "+(a.enabled?"onclick=\"nmdr.core.$('"+this.id+"').toggleCheckBox('"+a.id+"');\"":"")+"><table cellpadding='1' cellspacing='0' border='0'><tr><td style='vertical-align:middle;'><img id='"+this.id+"_nmdrRB_checkboxDiv_"+a.id+"_img' src='"+l+"' title='"+a.tooltip+"'></td><td style='vertical-align:middle;'><span>"+a.text+"</span></td></tr></table></div>")}i.push("</div>")}while(p<n.checkboxes.length)}if(n.radiobuttons.length>0){p=0;do{i.push("<div class='radiobuttonsDiv' style='display:inline-block;'>");for(u=0;p<n.radiobuttons.length&&!(u>0&&u%3==0);u++,p++){var c=n.radiobuttons[p],l=this.imagePath+(c.selected?"/radiobutton.png":"/radiobuttoff.png");i.push("<div class='radiobuttonDiv"+(c.enabled?"'":" itemDisabled'")+" id='"+this.id+"_nmdrRB_radiobuttonDiv_"+c.id+"' style='display:block;' "+(c.enabled?"onclick=\"nmdr.core.$('"+this.id+"').selectRadioButton('"+n.id+"','"+c.id+"');\"":"")+"><table cellpadding='1' cellspacing='0' border='0'><tr><td style='vertical-align:middle;'><img id='"+this.id+"_nmdrRB_radiobuttonDiv_"+c.id+"_img' src='"+l+"' title='"+c.tooltip+"'></td><td style='vertical-align:middle;'><span>"+c.text+"</span></td></tr></table></div>")}i.push("</div>")}while(p<n.radiobuttons.length)}if(n.comboboxes.length>0){var p=0;do{i.push("<div class='comboboxesDiv' style='display:inline-block;'>");for(var u=0;p<n.comboboxes.length&&!(u>0&&u%3==0);u++,p++){var b=n.comboboxes[p],h=this.id+"_nmdrRB_comboboxDiv_"+b.id,m=b.selected?"<span>"+b.selected+"</span>":"";i.push("<div class='comboboxDiv"+(b.enabled?"'":" itemDisabled'")+" id='"+h+"' style='display:block;width:"+b.width+"px;height:"+b.height+"px;'"+(b.enabled?"onclick=\"nmdr.core.$('"+this.id+"').openComboBox(event,'"+b.id+"');\"":"")+"><table cellpadding='1' cellspacing='0' border='0' width='100%' height='100%'><tr><td id='"+h+"_input' style='vertical-align:middle;border-right:1px solid #ccc; overflow:hidden; white-space:nowrap; text-overflow:clip;'>"+m+"</td><td style='width:18px; vertical-align:middle; text-align:center;padding:0 0 2px 2px;'><img src='"+this.imagePath+"/menuf.png'></td></tr></table></div>")}i.push("</div>")}while(p<n.comboboxes.length)}i.push("<div class='groupnameDiv' style='display:block;cursor:default;'>"+n.text+"</div>"),i.push("</div>")}document.getElementById(this.id+"_nmdrRB_container").innerHTML=i.join("")},e.readFromXML=function(t){for(var e=nmdr.core.xml.read(t,"Ribbon"),i=this.createRibbon(e),o=0,n=0;o<i.tabgroups.length;o++)for(var s=i.tabgroups[o],d=0;d<s.tabs.length;d++)s.tabs[d].groupnumber=o,s.tabs[d].number=n,this.tabs.push(s.tabs[d]),n++},e.createRibbon=function(t){var e={id:t.attributes.id,title:t.attributes.title,tabgroups:[]};e.tabgroups.push({id:"x",tabs:[{id:"x",text:"en"==this.lang?"BROWSE":"DURCHSUCHEN",groups:[]}]});for(var i in t.childNodes)t.childNodes[i].name&&e.tabgroups.push(this.addTabGroup(t.childNodes[i]));return e},e.addTabGroup=function(t){var e={id:t.attributes.id,color:t.attributes.color,tabs:[]};for(var i in t.childNodes)t.childNodes[i].name&&e.tabs.push(this.addTab(t.childNodes[i],e.color));return e},e.addTab=function(t,e){var i={id:t.attributes.id,text:t.attributes.text,groupnumber:-1,number:-1,color:e,groups:[]};for(var o in t.childNodes)t.childNodes[o].name&&i.groups.push(this.addGroup(t.childNodes[o]));return i},e.addGroup=function(t){var e={id:t.attributes.id,text:t.attributes.text,buttons:[],checkboxes:[],radiobuttons:[],comboboxes:[]};for(var i in t.childNodes){var o=t.childNodes[i].name;o&&"Button"==o?e.buttons.push(this.addButton(t.childNodes[i])):o&&"CheckBox"==o?e.checkboxes.push(this.addCheckBox(t.childNodes[i])):o&&"RadioButton"==o?e.radiobuttons.push(this.addRadioButton(t.childNodes[i])):o&&"ComboBox"==o&&e.comboboxes.push(this.addComboBox(t.childNodes[i]))}return e},e.addButton=function(t){var e={id:t.attributes.id,text:t.attributes.text,tooltip:t.attributes.tooltip,command:t.attributes.command,enabled:"true"==t.attributes.enabled.toLowerCase(),size:t.attributes.size,image:t.attributes.image,width:t.attributes.width?parseInt(t.attributes.width):this.buttonWidth,menu:[]};for(var i in t.childNodes)if(t.childNodes[i].name){var o=t.childNodes[i],n={id:o.attributes.id,text:o.attributes.text,tooltip:o.attributes.tooltip,description:o.attributes.description,image:o.attributes.image,command:o.attributes.command,enabled:"true"==o.attributes.enabled.toLowerCase()};e.menu.push(n)}return e},e.addCheckBox=function(t){return{id:t.attributes.id,text:t.attributes.text,tooltip:t.attributes.tooltip,command:t.attributes.command,enabled:"true"==t.attributes.enabled.toLowerCase(),checked:"true"==t.attributes.checked.toLowerCase()}},e.addRadioButton=function(t){return{id:t.attributes.id,text:t.attributes.text,tooltip:t.attributes.tooltip,command:t.attributes.command,enabled:"true"==t.attributes.enabled.toLowerCase(),selcted:"true"==t.attributes.selected.toLowerCase()}},e.addComboBox=function(t){return{id:t.attributes.id,items:t.attributes.items.split(","),selected:t.attributes.selected,command:t.attributes.command,enabled:"true"==t.attributes.enabled.toLowerCase(),width:parseInt(t.attributes.width),height:parseInt(t.attributes.height)}},e.prepareTestRibbon=function(){return"<?xml version=\"1.0\"?><Ribbon id='MyRibbon' title='MyRibbon'><TabGroup id='MyTabGroup'><Tab id='My ab' text='HELLO'><Group id='MyGroup' text='Group'><Button id='MyButton' text='Button' tooltip='Button' command='NewDocument' size='32' image='ribbon/32x32.png'></Button></Group></Tab></TabGroup></Ribbon>"},e}