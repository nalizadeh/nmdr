<!DOCTYPE HTML>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<title>nmdrToolkits Commands</title>

<style type="text/css"></style>

<script type="text/javascript" src="scripts/nmdr.js"></script>

<script type="text/javascript">

function prepareTestRibbon() {
	
    var xml = "<?xml version=\"1.0\"?>" +
    "<Commands id='MyCommands' title='MyCommands'>" +
        "<Group id='Aktionen' text='Aktionen'>" +
            "<Button id='NewRequest' " +
                    "text='Neuer Antrag' " +
                    "tooltip='Neuer Antrag' " +
                    "command='NewRequest' " +
                    "enabled='false' " +
                    "size='32' " +
                    "image='img/absence/NewRequest.png'>" +
            "</Button>" +
            "<Button id='EditRequest' " +
                    "text='Antrag bearbeiten' " +
                    "tooltip='Antrag bearbeiten' " +
                    "command='EditRequest' " +
                    "enabled='false' " +
                    "size='32' " +
                    "image='img/absence/EditRequest.png'>" +
            "</Button>" +
            "<Button id='WithdrawRequest' " +
                    "text='Antrag zurückziehen' " +
                    "tooltip='Antrag zurückziehen' " +
                    "command='WithdrawRequest' " +
                    "enabled='false' " +
                    "size='32' " +
                    "image='img/absence/WithdrawRequest.png'>" +
            "</Button>" +
            "<Button id='StartRequest' " +
                    "text='Genehmigung anfordern' " +
                    "tooltip='Genehmigung anfordern' " +
                    "command='StartRequest' " +
                    "enabled='false' " +
                    "size='32' " +
                    "image='img/absence/StartRequest.png'>" +
            "</Button>" +
        "</Group>" +
        "<Group id='Genehmigung' text='Genehmigung'>" +
            "<Button id='ApproveRequest' " +
                    "text='Genehmigen' " +
                    "tooltip='Genehmigen' " +
                    "command='ApproveRequest' " +
                    "enabled='false' " +
                    "size='32' " +
                    "image='img/absence/ApproveRequest.png'>" +
            "</Button>" +
            "<Button id='RejectRequest' " +
                    "text='Ablehnen' " +
                    "tooltip='Ablehnen' " +
                    "command='RejectRequest' " +
                    "enabled='false' " +
                    "size='32' " +
                    "image='img/absence/RejectRequest.png'>" +
            "</Button>" +
        "</Group>" +
        "<Group id='Stammdaten' text='Stammdaten'>" +
            "<Button id='ViewMasterData' " +
                    "text='Stammdaten anzeigen' " +
                    "tooltip='Stammdaten anzeigen' " +
                    "command='ViewMasterData' " +
                    "enabled='false' " +
                    "size='32' " +
                    "image='img/absence/ViewData.png'>" +
            "</Button>" +
        "</Group>" +
        "<Group id='Urlaubskontingent' text='Urlaubskontingent'>" +
            "<Button id='ViewThisYearQuota' " +
                    "text='Aktuelles Jahr anzeigen' " +
                    "tooltip='Aktuelles Jahr anzeigen' " +
                    "command='ViewThisYearQuota' " +
                    "enabled='false' " +
                    "size='32' " +
                    "width='80' " +
                    "image='img/absence/ViewYear.png'>" +
            "</Button>" +
            "<Button id='ViewNextYearQuota' " +
                    "text='Nächstes Jahr anzeigen' " +
                    "tooltip='Nächstes Jahr anzeigen' " +
                    "command='ViewNextYearQuota' " +
                    "enabled='false' " +
                    "size='32' " +
                    "width='80' " +
                    "image='img/absence/ViewYear.png'>" +
            "</Button>" +
        "</Group>" +
    "</Commands>";

    var commands = nmdr.commands("myCommands").build(xml, preCheckMethod, postCheckMethod, "de", 'img/');

    commands.actionPerformed = function (id) {
        if (id == "NewRequest") alert("DoNewRequest");
        else if (id == "EditRequest") alert("DoEditRequest");
        else if (id == "WithdrawRequest") alert("DoWithdrawRequest");
        else if (id == "StartRequest") alert("DoStartRequest");
        else if (id == "ApproveRequest") alert("DoApproveRequest");
        else if (id == "RejectRequest") alert("DoRejectRequest");
        else if (id == "ViewMasterData") alert("DoViewMasterData");
        else if (id == "ViewThisYearQuota") alert("DoViewThisYearQuota");
        else if (id == "ViewNextYearQuota") alert("DoViewNextYearQuota");
    };  
	
	//==== any selection or action on the site should invoke the following call
	commands.checkCommands();
}

function preCheckMethod(callback) {
	//=== perform load data etc.
	callback();
}

function postCheckMethod(commands) {

    //=== perform checks, validations etc. 

    commands["NewRequest"] = true;
    commands["EditRequest"] = true;
    commands["WithdrawRequest"] = true;
    commands["StartRequest"] = true;
    commands["ApproveRequest"] = true;
    commands["RejectRequest"] = false;
    commands["ViewMasterData"] = true;
    commands["ViewThisYearQuota"] = true;
    commands["ViewNextYearQuota"] = false;
}

</script> 

</head>
<body style='padding:0px; margin:0'>

<br>
<div id='myCommands'></div>
<script type="text/javascript">
nmdr.loadModule("commands", prepareTestRibbon);
</script>
</div>

</body>
</html>
